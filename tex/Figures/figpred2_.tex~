

\pgfplotsset{
    discard if/.style 2 args={
        x filter/.append code={
            \edef\tempa{\thisrow{#1}}
            \edef\tempb{#2}
            \ifx\tempa\tempb
                \def\pgfmathresult{inf}
            \fi
        }
    },
    discard if not/.style 2 args={
        x filter/.append code={
            \edef\tempa{\thisrow{#1}}
            \edef\tempb{#2}
            \ifx\tempa\tempb
            \else
                \def\pgfmathresult{inf}
            \fi
        }
    }
  }

  \begin{tikzpicture}[font=\bf\sffamily\fontsize{8}{10}\selectfont]
\def\TEXTCOL{gray}
    \tikzset{
        hatch distance/.store in=\hatchdistance,
        hatch distance=20pt,
        hatch thickness/.store in=\hatchthickness,
        hatch thickness=2pt
    }

%     \makeatletter
%     \pgfdeclarepatternformonly[\hatchdistance,\hatchthickness]{flexible hatch}
%     {\pgfqpoint{0pt}{0pt}}
%     {\pgfqpoint{\hatchdistance}{\hatchdistance}}
%     {\pgfpoint{\hatchdistance-1pt}{\hatchdistance-1pt}}%
%     {
%         \pgfsetcolor{\tikz@pattern@color}
%         \pgfsetlinewidth{\hatchthickness}
%         \pgfpathmoveto{\pgfqpoint{0pt}{0pt}}
%         \pgfpathlineto{\pgfqpoint{\hatchdistance}{\hatchdistance}}
%         \pgfusepath{stroke}
%     }
%     \makeatother
% \pgfdeclarepatternformonly{north east lines wide}%
%    {\pgfqpoint{-1pt}{-1pt}}%
%    {\pgfqpoint{10pt}{10pt}}%
%    {\pgfqpoint{9pt}{9pt}}%
%    {
%      \pgfsetlinewidth{0.4pt}
%      \pgfpathmoveto{\pgfqpoint{0pt}{0pt}}
%      \pgfpathlineto{\pgfqpoint{9.1pt}{9.1pt}}
%      \pgfusepath{stroke}
%     }

    \def\AUCXLABEL{time to pregnancy [months]}
    \def\LEGEND{AUC}
    \def\TIME{time}
    \def\AUCCOL{auc}
  \def\WDT{4.75in} 
  \def\WDTA{2in} 

  \def\datafile{\DATA/figfiles/model_complexity.csv}
  \def\riskfile{\DATA/figfiles/risk.csv}
  \def\sampleimg{\DATA/figfiles/sample.pdf}
  \def\sampledat{\DATA/figfiles/sampledat.csv}
  \def\auctime{\DATA/figfiles/auc_time.csv}
  \def\auctimeV{\DATA/figfiles/Vauc_time.csv}
  \def\randomsamples{\DATA/figfiles/cfbd_auctime.csv}
% need to add confidence bounds
  \def\randomsamples{\DATA/figfiles/auc_time.csv}

  
  \def\horzm{../../perturbation_browser/ntb/male_horizon.csv}
  \def\horzmt{../../perturbation_browser/ntb/male_horizon_T.csv}
 \def\horzf{../../perturbation_browser/ntb/female_horizon.csv}
  \def\horzft{../../perturbation_browser/ntb/female_horizon_T.csv}
  \def\perturbneg{../../perturbation_browser/ntb/perturb_neg.csv}
  \def\track{../../perturbation_browser/ntb/track.csv}

  \def\PNEGA{A020571551}
  \def\PNEGB{A005421148}
  \def\PNEGC{A033768823}
  \def\PPOSA{A006621658}
  \def\PPOSB{A002483419}
  \def\PPOSC{A069615715}

  \def\HGT{1.6in}
  \def\WDT{3.5in}
  \def\WDTC{4in}
  \def\WDTR{1.9in}
  \def\WDTH{1.70in}

  \def\AXISCOL{white}
\def\BANDCOL{lightgray}
\def\PLOTCOLA{black}
\def\PLOTCOLB{\MXCOL}
\def\PLOTCOLBu{\MXCOL}
\def\PLOTCOLC{black}
\def\PLOTCOLD{\FXCOL}
\def\FNCOLB{SeaGreen2}
\def\PLOTCOLDu{\FXCOL}
\def\WDTa{1.85in}
\def\HGTa{2.6in}
\def\HGTaa{6.3in}
\def\WDTb{1.7in}
\def\HGTb{2.5in}

\def\SCALE{1.5}
\def\SCALEA{1.15}
\def\SCALEB{1.75}
\def\OPC{.75}
\def\OPCB{.85}
\def\BWIDTH{3pt}
\def\LWDT{0.5mm}
  \node[] (A0) at (0,0) {};

  \node[anchor=center] (N) at ([yshift=1in]A0.south)
  {
    \begin{tikzpicture}
 %       \begin{axis} [,legend cell align={left},
 %      legend style={anchor=east,at={(0,1.05)},
 %        inner sep=3pt,
 %        draw=none,
 %        fill=white,fill opacity=.85,
 %        align=left,anchor=west,
 %        text opacity=1,
 %        font=\bf\sffamily\fontsize{8}{9}\selectfont,text=black},
 %      grid style={thick,dashed, gray!40},
 %      grid,
 %    enlargelimits=true,scale only axis=true,scaled x ticks = false,scaled y ticks = false,
 %     height=\HGTa,
 %    width=\WDTa,
 %    enlarge x limits=0.07,axis line style={\AXISCOL, opacity=1,ultra  thick, rounded corners=0pt}, y tick label style={/pgf/number format/fixed,/pgf/number format/precision=3,/pgf/number format/fixed zerofill,
 %     /pgf/number format/1000 sep = %\thinspace % Optional if you want to replace comma as the 1000 separator 
 %      },
 %      major tick length=0pt,legend columns=2, legend style={,xshift=-.5in,yshift=.2in},
 %      yshift=-.75in,text=\TEXTCOL,xlabel={age [weeks]},xlabel style={yshift=0.025in},ylabel
 %      style={xshift=-0.1in},ylabel={AUC},
 %      grid style={thick,dashed, gray!40},
 %      ymax=0.9]

      
 %    \addplot[forget plot,smooth, draw=none,,name path=AA]table[col sep=comma,x=week, y=ub, discard if not={gender}{M}, discard if not={dataset}{UCM}]
 %    {\randomsamples};
 %    \addplot[forget plot,smooth,  draw=none,,name path=BB]table[col sep=comma,x=week, y=lb, discard if not={gender}{M}, discard if not={dataset}{UCM}]
 %    {\randomsamples};
 %    \addplot[forget plot,\MXCOL,opacity=.175] fill between[of=AA and BB];
    
      
 %    \addplot[forget plot,smooth, draw=none,,name path=AA]table[col sep=comma,x=week, y=ub, discard if not={gender}{F}, discard if not={dataset}{UCM}]
 %    {\randomsamples};
 %    \addplot[forget plot,smooth,  draw=none,,name path=BB]table[col sep=comma,x=week, y=lb, discard if not={gender}{F}, discard if not={dataset}{UCM}]
 %    {\randomsamples};
 %    \addplot[forget plot,\FXCOL,opacity=.175] fill between[of=AA and BB];
    
    
 % \addplot[forget plot,smooth, draw=none,,name path=AA]table[col sep=comma,x=week, y=ub, discard if not={gender}{F}, discard if not={dataset}{Truven}]
 %    {\randomsamples};
 %    \addplot[forget plot,smooth,  draw=none,,name path=BB]table[col sep=comma,x=week, y=lb, discard if not={gender}{F}, discard if not={dataset}{Truven}]
 %    {\randomsamples};
 %    \addplot[forget plot,\MNCOL,opacity=.175] fill between[of=AA and BB];
    

    
 % \addplot[forget plot,smooth, draw=none,,name path=AA]table[col sep=comma,x=week, y=ub, discard if not={gender}{M}, discard if not={dataset}{Truven}]
 %    {\randomsamples};
 %    \addplot[forget plot,smooth,  draw=none,,name path=BB]table[col sep=comma,x=week, y=lb, discard if not={gender}{M}, discard if not={dataset}{Truven}]
 %    {\randomsamples};
 %    \addplot[forget plot,\FNCOL,opacity=.1750] fill between[of=AA and BB];
    

 %      \end{axis}

   \begin{axis} [,legend cell align={left},
      legend style={anchor=west,at={(0.5,1)},
        inner sep=3pt,
        draw=none,
        fill=white,fill opacity=.85,
        align=left,anchor=west,
        text opacity=1,
        font=\bf\sffamily\fontsize{8}{9}\selectfont,text=black},
      grid style={thick,dashed, gray!40},
      grid,
    enlargelimits=true,scale only axis=true,scaled x ticks = false,scaled y ticks = false,
     height=\HGTa,
    width=\WDTa,
    enlarge x limits=0.07,axis line style={\AXISCOL, opacity=1,ultra  thick, rounded corners=0pt}, y tick label style={/pgf/number format/fixed,/pgf/number format/precision=3,/pgf/number format/fixed zerofill,
     /pgf/number format/1000 sep = %\thinspace % Optional if you want to replace comma as the 1000 separator 
      },
      major tick length=0pt,legend columns=2, legend style={,xshift=-.5in,yshift=.2in},
      yshift=-.75in,text=\TEXTCOL,xlabel={\AUCXLABEL},xlabel style={yshift=0.025in},ylabel
      style={xshift=-0.1in},ylabel={AUC},
      grid style={thick,dashed, gray!40},
      ymax=0.9]
      
        \draw [draw=none,ultra thick,opacity=.3,postaction={
         pattern=flexible hatch,
        hatch distance=7pt,
        hatch thickness=2pt,
        draw=none,
        opacity=.5,
        pattern color=lightgray, %ultra thick,
     },] (axis cs:130,\pgfkeysvalueof{/pgfplots/ymin}) -- (axis cs:130,\pgfkeysvalueof{/pgfplots/ymax}) -- (axis cs:105,\pgfkeysvalueof{/pgfplots/ymax}) -- (axis cs:105,\pgfkeysvalueof{/pgfplots/ymin}) --cycle;

    \addplot[ smooth,  line width=\LWDT, \PLOTCOLB,mark=*, opacity=\OPC,
    mark options={%
      scale=\SCALEB,draw=\PLOTCOLB,  thick, fill=\PLOTCOLB,  opacity=\OPC,
    },]table[col sep=comma,x=\TIME, y=\AUCCOL, % discard if not={gender}{M}, discard if not={dataset}{Truven}
    ]
    {\randomsamples};
    %\addlegendentry{\LEGEND}


%     %
%     \addplot[ smooth,  line width=\LWDT, \PLOTCOLBu,mark=square*, opacity=.5,
%     mark options={%
%       scale=\SCALEA,draw=\PLOTCOLBu,  thick, fill=\PLOTCOLBu,  opacity=.5,
%     },]table[col sep=comma,x=week, y=v, discard if not={gender}{M}, discard if not={dataset}{UCM}]    {\randomsamples};
%     \addlegendentry{Males (UCM)}





    
%     \addplot[ smooth,  line width=\LWDT, \PLOTCOLD,mark=*, opacity=\OPCB,
%     mark options={%
%       scale=\SCALEB,draw=\PLOTCOLD,  thick, fill=\PLOTCOLD,  opacity=\OPCB,
%     },]table[col sep=comma,x=week, y=v, discard if not={gender}{F}, discard if not={dataset}{Truven}]    {\randomsamples};
%     \addlegendentry{Females (Truven)}
% %
% %
%     \addplot[ smooth,  line width=\LWDT, \PLOTCOLDu,mark=square*, opacity=.5,
%     mark options={%
%       scale=\SCALEA,draw=\PLOTCOLDu,  thick, fill=\PLOTCOLDu,  opacity=.5,
%     },]table[col sep=comma,x=week, y=v, discard if not={gender}{F}, discard if not={dataset}{UCM}]    {\randomsamples};
%     \addlegendentry{Females (UCM)}



    

  \end{axis}



\end{tikzpicture}
  };

  
  \node[anchor=north west] (A) at ([xshift=0in,yshift=-0.1in]N.north east) {
    \begin{tikzpicture}[anchor=center]
  \begin{groupplot}[group style={group name=A,group size= 2 by 1,horizontal sep=.5in},legend style={anchor=east,at={(.5,1.025)},/tikz/every even column/.append style={column sep=1.5in},legend cell align={left},inner sep=3pt,draw=none,fill=white,fill opacity=.85,align=right,text opacity=1,font=\bf\sffamily\fontsize{8}{9}\selectfont},axis line style={lightgray, opacity=0, thin},%
    enlargelimits=true,
     width=\HGT,
    height=\HGTaa,
     enlarge y limits=0.03,
    ] 
    \nextgroupplot[xbar,bar width=\BWIDTH,    
ytick=data,% crucial line for the xticklabels directive 
    ymin=0, 
    yticklabels from table={\datafile}{feature},
    yticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,align=right,rotate=0, 
text width=1.1in, anchor=east, yshift=0in,xshift=-.045in,text=\TEXTCOL},
    major tick length=0pt,
    yticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,text=\TEXTCOL},
    %grid,
    grid style={lightgray, opacity=.7},
    axis on top=false, 
    xlabel={No. of model states},
    ylabel style={yshift=-1.25in,text=\TEXTCOL},,ylabel style={yshift=-.15in},
    ylabel={disease groups and/or individual ICD9 codes}]
    \addplot[opacity=1,fill=\MNCOL, area legend] table [ 
    y expr=\coordindex,
    x=NEGF
    ] {\datafile};   
    \addlegendentry{Control}
    \addplot[opacity=1,fill=\MXCOL, area legend] table [ 
    y expr=\coordindex,
    x=POSF
    ] {\datafile};   
    \addlegendentry{Positive}

%     \nextgroupplot[xbar,bar width=\BWIDTH,    ytick=data,% crucial line for the xticklabels directive 
%     ymin=0, 
%     yticklabels from table={\datafile}{feature},
%     yticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,align=right,rotate=0, 
% text width=1.1in, anchor=east, yshift=0in,xshift=-.045in,text=\TEXTCOL},
%     major tick length=0pt,
%     yticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,text=Red1},
%     %grid,
%     grid style={lightgray, opacity=.7},
%     axis on top=false, 
%     xlabel={model complexity (no. of states)},
%     ylabel style={yshift=-0.69in,text=\TEXTCOL},yticklabels=\empty,xlabel style={text=\TEXTCOL,xshift=-.7in,yshift=.05in},]
%     \addplot[opacity=1,fill=\FNCOLB, area legend] table [ 
%     y expr=\coordindex,
%     x=NEGF
%     ] {\datafile};   
%     \addlegendentry{Female Control}
%     \addplot[opacity=1,fill=\FXCOL, area legend] table [ 
%     y expr=\coordindex,
%     x=POSF
%     ] {\datafile};   
%     \addlegendentry{Female Positive}
  \end{groupplot}
\end{tikzpicture}
};




\node[anchor=north west] (B) at ([yshift=-.275in]N.south west)
{
  \begin{tikzpicture}[]
    \begin{groupplot}[group style={group name=A,group size= 1 by 2, vertical sep=.35in},legend cell align={left},
      legend style={anchor=east,at={(-.2,1.05)},
        inner sep=3pt,
        draw=none,
        fill=white,fill opacity=.85,
        align=left,anchor=west,
        text opacity=1,
        font=\bf\sffamily\fontsize{8}{9}\selectfont,text=black},
      grid style={thick,dashed, gray!40},
      grid,
    enlargelimits=true,scale only axis=true,scaled x ticks = false,scaled y ticks = false,
     height=\HGTb,
    width=\WDTb,
    enlarge x limits=0.03,axis line style={\AXISCOL, opacity=1,ultra  thick, rounded corners=0pt}, y tick label style={/pgf/number format/fixed,/pgf/number format/precision=3,/pgf/number format/fixed zerofill,
     /pgf/number format/1000 sep = %\thinspace % Optional if you want to replace comma as the 1000 separator 
      },
      major tick length=0pt]

   %  \nextgroupplot[xticklabels=\empty,text=\TEXTCOL]
   %  \addplot[ smooth,  line width=\LWDT, \MNCOL,mark=*, opacity=.85,
   %  mark options={%
   %    scale=\SCALE,draw=\MNCOL,  thick, fill=\MNCOL,  opacity=1,
   %  },]table[col sep=comma,x=time, y=mcontrolM]
   %  {\riskfile};
   %  \addlegendentry{Males Control};
 

   % \addplot[forget plot,smooth, draw=none,,name path=AA]table[col sep=comma,x=time, y=UcontrolM]
   %  {\riskfile};
   %  \addplot[forget plot,smooth,  draw=none,,name path=BB]table[col sep=comma,x=time, y=LcontrolM]
   %  {\riskfile};
   %  \addplot[forget plot,\MNCOL,opacity=.175] fill between[of=AA and BB];
    

    
   %  \addplot[ smooth,  line width=\LWDT, \MXCOL,mark=*, opacity=.85,
   %  mark options={%
   %    scale=\SCALE,draw=\MXCOL,  thick, fill=\MXCOL,  opacity=1,
   %  },]table[col sep=comma,x=time, y=mtreatmentM]
   %  {\riskfile};
   %  \addlegendentry{Males Positive};


    
   % \addplot[smooth, draw=none,,name path=A]table[col sep=comma,x=time, y=UtreatmentM]
   %  {\riskfile};
   %  \addplot[smooth,  draw=none,,name path=B]table[col sep=comma,x=time, y=LtreatmentM]
   %  {\riskfile};
   %  \addplot[\MXCOL,opacity=.175] fill between[of=A and B];
    

    \nextgroupplot[xlabel={\AUCXLABEL},text=\TEXTCOL,xlabel style={yshift=0.025in},,ylabel={risk (99\% confidence)},ylabel style={xshift=-.7in,yshift=.15in}]
    \addplot[ smooth, line width=\LWDT, \FNCOL,mark=*, opacity=.85,
    mark options={%
      scale=\SCALE,draw=\FNCOL,  thick, fill=\FNCOL,  opacity=1,
    },]table[col sep=comma,x=time, y=mcontrol]
    {\riskfile};
    \addlegendentry{Control};

   \addplot[forget plot,smooth, draw=none,,name path=Ax,]table[col sep=comma,x=time, y=Ucontrol]
    {\riskfile};
    \addplot[forget plot,smooth, draw=none,,name path=Bx]table[col sep=comma,x=time, y=Lcontrol]
    {\riskfile};
    \addplot[forget plot,\FNCOL,opacity=.175] fill between[of=Ax and Bx];
    

    
    \addplot[ smooth,  line width=\LWDT, \PLOTCOLD,mark=*, opacity=.85,
    mark options={%
      scale=\SCALE,draw=\PLOTCOLD,  thick, fill=\PLOTCOLD,  opacity=1,
    },]table[col sep=comma,x=time, y=mtreatment]
    {\riskfile};
    \addlegendentry{Positive};

   \addplot[smooth, draw=none,,name path=A]table[col sep=comma,x=time, y=Utreatment]
    {\riskfile};
    \addplot[smooth,  draw=none,,name path=B]table[col sep=comma,x=time, y=Ltreatment]
    {\riskfile};
    \addplot[\PLOTCOLD,opacity=.175] fill between[of=A and B];

\end{groupplot}


    \end{tikzpicture}
  };
%     ###########################################
%     ###########################################
%     ###########################################
  \def\WDTX{4.675in}
  \def\HGTX{1.35in}
  
   \node [anchor=north west] (D) at (B.north east)
   {
%     \begin{tikzpicture}
%       \begin{axis}[legend cell align=left,legend style={anchor=east,at={(0.35,.85)},
%           inner sep=3pt,draw=none,fill=none,fill opacity=.85,
%           align=right,text opacity=1,
%           font=\bf\sffamily\fontsize{8}{9}\selectfont},,axis line style={lightgray, opacity=0, thin},%
%         height=\HGTX, width=\WDTX,
%         %ybar,bar width=4pt,    
%         major tick length=0.0pt,
%         ylabel={probability},
%         %xmin=100,
%         %xmax=0.35,
%         xticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,text=\TEXTCOL},
%         %grid,
%         grid style={lightgray, dashed,opacity=.7},
%         axis on top=false, 
%         xlabel={time to clinical diagnosis [$\Delta$ weeks]}, x tick label style={yshift=0.05in,text=\TEXTCOL},
%         xlabel style={yshift=0.05in,text=\TEXTCOL},ylabel style={yshift=0.05in,xshift=-.4in,text=\TEXTCOL},x tick label style={,text=\TEXTCOL,xshift=.1in,yshift=-.05in,/pgf/number format/fixed,/pgf/number format/precision=2,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace
%         },y tick label style={text=\TEXTCOL,/pgf/number format/fixed,/pgf/number format/precision=3,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace 
%         },scaled ticks=false, enlarge y limits=0.07,enlarge x limits=0,x dir=reverse
%         ]
% \def\OPC{.2}
%      \addplot[smooth, ultra thick, fill=\FXCOL, fill opacity=\OPC,draw=\FXCOL,area legend,,name path=A]table[col sep=comma,x=x, y=pdf]
%     {\horzf};
%           \addlegendentry{Female (UCM)}
%    \addplot[smooth, draw=lightgray, very thick, fill=Lavender, fill opacity=\OPC,,,name path=A,area legend,postaction={
%          pattern=flexible hatch,
%         hatch distance=7pt,
%         hatch thickness=1pt,
%         draw=none,
%         opacity=1,
%         pattern color=lightgray, %ultra thick,
%      },]table[col sep=comma,x=x, y=pdf]
%     {\horzft};
%     \addlegendentry{Female (Truven)}
%     %
%     \addplot[smooth, draw=gray,ultra thick, opacity=0.7,fill=none,area legend, fill opacity=\OPC,,name path=A]table[col sep=comma,x=x, y=pdf]
%     {\horzm};
%     \addlegendentry{Male (UCM)}
%     %
%     \addplot[smooth, draw=black,  thick, fill=none, fill opacity=\OPC,,area legend,,name path=A]table[col sep=comma,x=x, y=pdf]
%     {\horzmt};
%     \addlegendentry{Male (Truven)}

%      \draw [CadetBlue4,,semithick] (axis cs:129,\pgfkeysvalueof{/pgfplots/ymin}) -- (axis cs:129,\pgfkeysvalueof{/pgfplots/ymax}) node [pos=1.0,,above,yshift=-0.15in,xshift=-.0in,fill=white] {129 weeks};
%      \draw [CadetBlue4,,semithick] (axis cs:188,\pgfkeysvalueof{/pgfplots/ymin}) -- (axis cs:188,\pgfkeysvalueof{/pgfplots/ymax}) node [pos=1.0,,above,yshift=-0.15in,xshift=-.0in,fill=white] {188 weeks};
%        \end{axis}
%      \end{tikzpicture}
    };
 

      \node [anchor=north west] (E) at ([xshift=0in,yshift=-.62in]D.south west)
  {
    \begin{tikzpicture}
%       \begin{axis}[legend cell align=left, legend columns=2,     legend style={,anchor=east,at={(1,1.2)},
%           inner sep=3pt,draw=none,fill=white,fill opacity=.85,
%           align=right,text opacity=1,
%           font=\bf\sffamily\fontsize{8}{9}\selectfont},,axis line style={lightgray, opacity=0, thin},%
%         height=1.95in,
%         width=1.85in,
%         %ybar,bar width=4pt,    
%         major tick length=0.0pt,
%         ylabel={\% $\Delta$ Risk (99\% conf.)},
%         xmin=40,
%         %xmax=0.35,
%         xticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,text=\TEXTCOL},
%         grid,
%         grid style={lightgray, dashed,opacity=.7},
%         axis on top=false, 
%         xlabel={age [weeks]}, x tick label style={yshift=0.0in,text=\TEXTCOL},
%         xlabel style={yshift=0.0in,text=\TEXTCOL},ylabel style={yshift=-0.1in,xshift=-.7in,text=\TEXTCOL},x tick label style={,text=\TEXTCOL,xshift=.1in,yshift=-.05in,/pgf/number format/fixed,/pgf/number format/precision=2,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace
%         },y tick label style={text=\TEXTCOL,/pgf/number format/fixed,/pgf/number format/precision=0,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace 
%         },x tick label style={xshift=-.1in,text=\TEXTCOL,/pgf/number format/fixed,/pgf/number format/precision=0,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace 
%         },scaled ticks=false, enlarge y limits=0.07,enlarge x limits=0,
%         ]
% \def\OPC{.2}
%      \addplot[smooth, ultra thick,draw=\FXCOL,,name path=A]table[col sep=comma,x=week, y=MEDIANF]
%     {\perturbneg};
%           \addlegendentry{Female}
%      \addplot[smooth, ultra thick,draw=\MXCOL,,name path=A]table[col sep=comma,x=week, y=MEDIANM]
%     {\perturbneg};
%     \addlegendentry{Male}

%      \addplot[forget plot,smooth, ultra thick,draw=none,,name path=A]table[col sep=comma,x=week, y=UBM]
%     {\perturbneg};
%       \addplot[forget plot,smooth, ultra thick,draw=none,,name path=B]table[col sep=comma,x=week, y=LBM]
%       {\perturbneg};
%           \addplot[forget plot,\FXCOL,opacity=.085] fill between[of=A and B];
%    \addplot[forget plot,smooth, ultra thick,draw=none,,name path=A]table[col sep=comma,x=week, y=UBF]
%     {\perturbneg};
%       \addplot[forget plot,smooth, ultra thick,draw=none,,name path=B]table[col sep=comma,x=week, y=LBF]
%       {\perturbneg};
%           \addplot[forget plot,\MXCOL,opacity=.085] fill between[of=A and B];

%        \end{axis}
      \end{tikzpicture}
    };
\definecolor{alizarin}{rgb}{0.82, 0.1, 0.26}
\definecolor{amber}{rgb}{1.0, 0.75, 0.0}
\definecolor{amethyst}{rgb}{0.6, 0.4, 0.8}
\definecolor{apricot}{rgb}{0.98, 0.81, 0.69}
\definecolor{atomictangerine}{rgb}{1.0, 0.6, 0.4}
\definecolor{awesome}{rgb}{1.0, 0.13, 0.32}
\definecolor{azurec}{rgb}{0.0, 0.5, 1.0}
\definecolor{ballblue}{rgb}{0.13, 0.67, 0.8}
\definecolor{bittersweet}{rgb}{1.0, 0.44, 0.37}
\definecolor{bluem}{rgb}{0.0, 0.5, 0.69}
\definecolor{brightturquoise}{rgb}{0.03, 0.91, 0.87}
\definecolor{fiveA}{HTML}{30a2da}
\definecolor{fiveB}{HTML}{fc4f30}
\definecolor{fiveC}{HTML}{e5ae38}
\definecolor{fiveD}{HTML}{6d904f}
\definecolor{fiveE}{HTML}{8b8b8b}

\def\CINF{Red4}
\def\CNEO{SeaGreen4}
\def\CIMM{Red1}
\def\CBLD{lightgray}
\def\CNRV{fiveA}
\def\CCIR{Green2}
\def\CRSP{fiveE}
\def\CDIG{bittersweet}
\def\CSKN{Cyan3}
\def\CMSK{Indigo}
\def\CCNT{Orchid3}
\def\CPRI{MediumBlue!80}
\def\CINJ{amber}
\def\CMNT{DarkGreen!90}
\def\CGNT{DarkOrange3}
\def\CILL{black}
\def\HCOL{black}
\def\HBLK{gray}
\def\SCALEB{1.2}
\def\OPC{.6}
\def\SCALER{0.01}
\node [anchor=north west] (F) at ([xshift=0.1in,yshift=0in]E.north east)
  {
%    \begin{tikzpicture}
%       \begin{axis}[legend cell align=left, legend columns=3,     legend style={,anchor=east,at={(1.05,1.2)},
%           inner sep=3pt,draw=none,fill=white,fill opacity=.85,
%           align=right,text opacity=1,text=\TEXTCOL,
%           font=\bf\sffamily\fontsize{8}{9}\selectfont},,axis line style={lightgray, opacity=0, thin},%
%         height=1.88in,
%         width=2.85in,
%         %ybar,bar width=4pt,    
%         major tick length=0.0pt,
%         ylabel={absolute risk},
%         xmin=0,
%         xmax=150,
%         xticklabel style={font=\bf\sffamily\fontsize{7}{7}\selectfont,text=\TEXTCOL},
%         grid,
%         grid style={lightgray, dashed,opacity=.7},
%         axis on top=false, 
%         xlabel={age [weeks]}, x tick label style={yshift=0.05in,text=\TEXTCOL},
%         xlabel style={yshift=0.05in,text=\TEXTCOL},ylabel style={yshift=0.05in,xshift=-0.2in,text=\TEXTCOL},x tick label style={,text=\TEXTCOL,xshift=.1in,yshift=-.05in,/pgf/number format/fixed,/pgf/number format/precision=2,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace
%         },y tick label style={text=\TEXTCOL,/pgf/number format/fixed,/pgf/number format/precision=3,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace 
%         },,x tick label style={xshift=-.1in,text=\TEXTCOL,/pgf/number format/fixed,/pgf/number format/precision=0,/pgf/number format/fixed zerofill,
%           /pgf/number format/1000 sep = %\thinspace 
%         },scaled ticks=false, enlarge y limits=0.07,enlarge x limits=0,
%         ]
%         \addplot[forget plot,smooth,draw=black,ultra thick, line width = 5pt,opacity=0 , mark=none,  mark options={%
%        scale=\SCALEB,
%        opacity=0.05,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week]
%     {\track};
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CILL,draw=\CILL,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{15.0}]
%      {\track};
%      \addlegendentry{ill defn.}
% %
%  %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CMSK,draw=\CMSK,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{12.0}]
%     {\track};
%      \addlegendentry{musc. skltl.}
% %
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CPRI,,draw=\CPRI,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{14.0}]
%     {\track};
%      \addlegendentry{cond. orig. in perintl.}
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CINJ,draw=\CINJ,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{16.0}]
%     {\track};
%      \addlegendentry{injury}
% %
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CIMM,draw=\CIMM,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{2.0}]
%     {\track};
%      \addlegendentry{immun.}
% %
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CNRV,draw=\CNRV,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{5.0}]
%     {\track};
%      \addlegendentry{nerv. \& sensory}
% %
% %
%         \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CRSP,draw=\CRSP,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{7.0}]
%     {\track};
%      \addlegendentry{respir.}
% %
%        \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CDIG,draw=\CDIG,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{8.0}]
%     {\track};
%      \addlegendentry{digest.}
%        \addplot[,only marks, mark=*,  mark options={%
%        scale=\SCALEB,fill=\CINF,draw=\CINF,
%        opacity=\OPC,
%      }]table[col sep=comma,y expr=\thisrowno{1}*\SCALER, x=week,discard if not={icdclass}{0.0}]
%     {\track};
%      \addlegendentry{infection}
%     % 
%   \end{axis}
%       \end{tikzpicture}
    };





   \node[anchor=south west,align=left] (LA) at ([xshift=.2in,yshift=-0in]N.north west) {{\LARGE A.} AUC over age  };
   \node[anchor=north west,align=left] (LB) at ($(LA.north west)!(A.north west)!(LA.north east)$) {{\LARGE C.} Model Complexity for Control \& Positive Groups  };
  \node[anchor=south west,align=left] (LB1) at ($(LA.north west)!(B.north west)!(LA.south west)$) {{\LARGE B.} Average risk over age   };
  % \node[anchor=south west,align=left] (LB2) at ($(LB1.south west)!(LB.west)!(LB1.south east)$) {{\LARGE C.} Time to Clinical Diagnosis after Relative Risk $> 90\%$   };
 %  \node[anchor=south west,align=left] (LB3) at ([xshift=-.6in,yshift=.1in]$(LB2.south west)!(E.north west)!(LB2.north west)$) {{\LARGE D.} Effect of Early Exposure \\($<50$ weeks)  to  Diseases  };

 % \node[anchor=north west,align=left] (LB3) at ([xshift=0.2in]$(LB3.north west)!(F.north west)!(LB3.north east)$) {{\LARGE E.} Risk Progression Example with disorders\\color-coded  in diagnostic history\\(Truven database, clinical diagnosis at $148$ wk) };



\end{tikzpicture}

