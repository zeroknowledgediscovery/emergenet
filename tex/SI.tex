\documentclass[onecolumn,10pt]{IEEEtran}
\let\labelindent\relax
\usepackage{enumitem}
\input{preamble.tex} 

\pagestyle{fancy}
\rhead{\footnotesize\bf\sffamily\thepage}
\cfoot{}
%\cfoot{\scriptsize For Nature Letter \today}
%--------------
\externaldocument[SI-]{SI}
\externaldocument[main-]{main}
%--------------
\input{customdef}

\title{Supplementary Text: \\ \TITLE} 

\tikzXtrue
%\tikzXfalse
%\pgfplotsset{compat=1.18} 
\begin{document} 
\maketitle   


   


\section*{Supplementary Methods: Notes on q-Distance \& Supporting Results}

The \textit{q-distance} is a pseudo-metric since  distinct sequences can induce the same distributions over each index, and thus evaluate to have a zero distance. This is  actually desirable; we do not want our distance to be  sensitive to changes that are not biologically relevant. The intuition is that  not all sequence variations brought about by substitutions are equally important or likely. Even with no  selection pressure, we might still see random  variations at an index if such variations do not affect the replicative fitness. Under that scenario, the corresponding $\Phi_i$ will predict a flat distribution no matter what the input sequence is, thus contributing nothing to the overall distance. And even if two strains $x,y$ have the same entry at some index $i$, the remaining residues  might induce different distributions $\Phi_i$ based on the remote dependencies, $i.e.$, the entries in $x_{-i},y_{-i}$. Also, it matters if the sequences come from two different background populations $P,Q$, $i.e.$, if the induced Qnets $\Phi^P,\Phi^Q$ are different. Thus, if we construct Qnets for H1N1 Influenza A separately for the collection years 2008 and 2009, then the same exact sequence collected in the respective years might have a non-zero distance between them, reflecting the fact that the background population the sequences arose from are different, inducing possibly different expected mutational tendencies (See SI-Table~\ref{SI-tabex}).

Next, we induce q-distance  between a sequence and a population and between two populations.
\begin{defn}[Pseudo-metric between populations]
Using the notion of Hausdorff metric between sets:
\cgather{
\forall x \in P, y \in Q, \notag \\ \theta(x,Q) = \min_{y \in Q} \theta(x,y)\\
\theta(P,Q) =  \max \left \{ \max_{x \in P} \theta(x,Q) ,\max_{y \in Q} \theta(y,P) 
\right \} }
\end{defn}





\subsection*{In-silico Corroboration of \qnet Constraints}

We carry out in-silico experiments to corroborate that the constraints represented within an inferred \qnet are indeed reflective of the  biology in play. We compare the results of simulated mutational perturbations to sequences from our databases (for which we have already constructed \qnet{s}), and then use NCBI BLAST (\href{https://blast.ncbi.nlm.nih.gov/Blast.cgi}{https://blast.ncbi.nlm.nih.gov/Blast.cgi}) to identify  if  our perturbed sequences match with existing sequences in the databases (See  SI-Fig.~\ref{SI-figsoa}). We find that in contrast to random variations, which rapidly diverge the trajectories, the \qnet constraints tend to produce smaller variance in the trajectories, maintain a high degree of match as we extend our trajectories, and produces matches closer in time to the collection time of the  initial sequence | suggesting that the \qnet  does indeed capture realistic constraints.









\subsection*{Multivariate Regression to Identify Factors in Strain Prediction}

We investigate the key factors that contribute to our successful prediction of the dominant strain in the next season. We carry out a multivariate regression with data diversity, the complexity of inferred \qnet and the edit distance of the WHO recommendation from the dominant strain as independent variables. Here we define data diversity as the number of clusters we have in the input set of sequences, such that any two sequences five or less mutations apart are in the same cluster. \qnet complexity is measured by the number of decision nodes in the component decision trees of the recursive forest.

We select several plausible structures of the regression equation, and in each case conclude that  data diversity has the most important and statistically significant contribution (See SI-Tab.~\ref{tabreg}).

\bibliographystyle{vancouver}
\bibliography{allbib}

\clearpage





\section*{Supplementary Figures \& Tables}

\input{SIfig.tex}





\end{document}